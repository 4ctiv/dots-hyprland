# This is a modified configuration of Arcolinux
# Modified by 4ctiv
#
# Please note not all available settings / options are not set here.
# For more managable files this configuration is split into:
# - hyprland.conf: This file, holds the main configuration
# - hyprland-var.conf: Hyprland settings variables (for use in configs) 
# - hyprland-theme.conf: This file holds theme related configurations
# - hyprland-keybinds.conf: This file holds all keybindings
# - hyprland-autostart.conf: This file holds startup rules and autostart apps
# Info @ https://wiki.hyprland.org/


#   ##########################################################################
#  ###    Variables, Definitions, etc.                                    ###
# ##########################################################################
# See https://wiki.hyprland.org/Configuring/Keywords/ for more
source = ~/.config/hypr/hyprland-var.conf

#   ##########################################################################
#  ###    Theming, etc.                                                   ###
# ##########################################################################
# See https://wiki.hyprland.org/Getting-Started/Master-Tutorial/#themes
source = ~/.config/hypr/hyprland-theme.conf # Import variables

#   #############################
#  ### Environment variables ###
# #############################
# See: https://wiki.hyprland.org/Configuring/Environment-variables/
#debug{
#  disable_logs = false
#  disable_time = false
#  enable_stdout_logs = true
#  colored_stdout_logs = true
#}

# Hyprland settings
 env = HYPRCURSOR_SIZE,24
 env = HYPRLAND_TRACE,1
 env = HYPRLAND_LOG_WLR,1
# XDG settings
 env = XDG_CURRENT_DESKTOP,Hyprland
 env = XDG_SESSION_DESKTOP,Hyprland
 env = XDG_SESSION_TYPE,wayland
# GTK settings
 env = GTK_THEME,gtk_catppuccin-mocha-maroon
 env = GDK_BACKEND,wayland,x11
 exec-once = gsettings set org.gnome.desktop.interface color-scheme "prefer-dark"
# QT settings
 env = QT_CURSOR_SIZE,24
 env = QT_AUTO_SCREEN_SCALE_FACTOR,1
 env = QT_QPA_PLATFORM,wayland;xcb
 env = QT_QPA_PLATFORMTHEME,qt5ct # Alt.: qt5ct:qt6ct:gtk2:gnome
 env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1
# Clutter settings
 env = CLUTTER_BACKEND,wayland
# Electron settings
# (> Electron 28) "--enable-features=UseOzonePlatform --ozone-platform=wayland"
 env = ELECTRON_OZONE_PLATFORM_HINT, auto # alt.: wayland
# XWayland setting
 env = XCURSOR_SIZE,24

#   ###################
#  # Default software #
# ####################
#            xdg-mime default PROGRAM.desktop          mime/type
 exec-once = xdg-mime default nemo.desktop             inode/directory
 exec-once = xdg-mime default inkscape.desktop         image/svg+xml
 exec-once = xdg-mime default gimp.desktop             image/png
 exec-once = xdg-mime default org.gnome.Papers.desktop application/pdf
                             #com.github.xournalpp.xournalpp.desktop application/pdf
 exec-once = xdg-mime default google-chrome.desktop    x-scheme-handler/zoommtg

#   ################
#  # Hyprland GPU #
# ################
# lspci -k | grep VGA && wlr-randr --dryrun # Show avalable GPU's ID

# Select GPU
# env = WLR_DRM_DEVICES,"/dev/dri/card1:/dev/dri/card0" # gpu usage policy: gpu0 > gpu1

# GPU: Intel Arc hw-raytracing support
 env = VKD3D_CONFIG,dxr11,dxr

# GPU: SDL2 applications on Wayland
 env = SDL_VIDEODRIVER,wayland

# GPU: NVIDIA Settings
#env = GBM_BACKEND,nvidia-drm
#env = __GLX_VENDOR_LIBRARY_NAME,nvidia
#env = LIBVA_DRIVER_NAME,nvidia
#env = __GL_GSYNC_ALLOWED,1
#env = __GL_VRR_ALLOWED,0
#env = WLR_DRM_NO_ATOMIC,1

#   ################
#  #  Text Input  #
# ################
# IME Support: fcitx (need to be installed)
#env = GTK_IM_MODULE=fcitx
#env = QT_IM_MODULE=fcitx
#env = XMODIFIERS=@im=fcitx
#env = SDL_IM_MODULE=fcitx
#env = GLFW_IM_MODULE=ibus

#   ##########################################################################
#  ###    Monitors, Displays, etc.                                        ###
# ##########################################################################
# Configure your Display resolution, offset, scale and Monitors here, use `hyprctl monitors` to get the info.
# See https://wiki.hyprland.org/Configuring/Monitors/
source = ~/.config/hypr/hyprland-displays.conf

#   #####################
#  # Special Workspace #
# #####################

# special workspace (Scratchpad)
 workspace = special:special   ,on-created-empty: [workspace special:special; float; size 1900 324; move 10 40; silent; opacity 0.7;] $term
   bezier = overshoot, 0.05, 0.9, 0.1, 1.1
   animation = specialWorkspace, 1, 10, overshoot , slidefadevert -20%
# overlay  workspace
 workspace = special:draw      , gapsin:0, gapsout:0, on-created-empty: [workspace special:draw] which gromit-mpx || $term bash -c "paru -S gromit-mpx" ; gromit-mpx --active
 workspace = special:screenshot, gapsin:0, gapsout:0, on-created-empty: $screenshot
# mail workspace
 workspace = name:mail  , gapsin:0, gapsout:0, on-created-empty: thunderbird

#   ##########################################################################
#  ###    Hyprland basic configurations                                   ###
# ##########################################################################

misc {
  # Battery optimisation: enable vfr (variable refresh rate)
  vfr = true
  vrr = 3
  disable_hyprland_logo = true
  disable_splash_rendering = true
  mouse_move_enables_dpms = true
  on_focus_under_fullscreen=2
  enable_anr_dialog = false # Disabe "App not responding" prompts
}

#   ######################
#  ### Window layouts ###
# ######################

general {
  layout = dwindle
 #layout = master
}
dwindle {
  # See https://wiki.hyprland.org/Configuring/Dwindle-Layout/ for more
  pseudotile = true
  preserve_split = true
 #no_gaps_when_only = 1
}

master {
  # See https://wiki.hyprland.org/Configuring/Master-Layout/ for more
  # new_is_master = true
  new_on_top = true # New window in stack view if true else new window focused on left
  mfact = 0.5
}

#   ##########################################################################
#  ###    HW/Device specific rules (window rules)                         ###
# ##########################################################################
# See https://wiki.hyprland.org/Configuring/Variables/#input
#
# Example per-device config
# See https://wiki.hyprland.org/Configuring/Keywords/#executing for more
#device:epic mouse V1 {
#  sensitivity = -0.5
#}

# Wired Keyboard
#device {
#  name       = keyboard
#  kb_model   =
#  kb_layout  = de,us
#  kb_variant =
#  kb_options = grp:caps_toggle,fkeys:basic_13-24
#  kb_rules   =
#  kb_file    =
#}

#   ###########################################################################
#  ###    Application specific rules (window rules)                        ###
# ##########################################################################
# See https://wiki.hyprland.org/Configuring/Window-Rules/ for more

windowrule = float on, match:class ^(Emulator)$
windowrule = float on, match:class ^(squeekboard)$, match:title ^(Squeekboard)$
windowrule = float on, match:class ^(Minecraft Launcher)$, match:title ^(Minecraft Launcher)$
windowrule = pin on, match:class ^.*(polkit).*$              title:^(Auth).*$

# Setup quickgui
windowrule = float on, center on, match:class ^(quickgui)$, match:title ^(quickgui)$

# Setup keepassxc
windowrule = float on, center on, size 1100 550, no_screen_share on, match:class ^((org.keepassxc.)?KeePassXC)$

# Setup showmethekeys overlay
windowrule = float on, pin on, size (monitor_w*0.6) (monitor_h*0.05), move ((monitor_w*0.2)) ((monitor_h*0.92)), rounding 15, no_shadow on, border_size 0, no_focus on, no_blur on, match:class ^(showmethekey-gtk)$

# Setup livecaptions overlay
windowrule = float on, pin on, size (monitor_w*0.6) (monitor_h*0.05), move ((monitor_w*0.2)) ((monitor_h*0.92)), opacity 0.7, rounding 15, no_shadow on, border_size 0, no_initial_focus on, no_blur on, match:class ^(net.sapples.LiveCaptions)$

# floating window rules
windowrule = border_size 3, match:float 1

# specific window centering
windowrule = center on, match:class (blueberry)
windowrule = center on, match:class (wofi)
windowrule = center on, match:class (lutris)
windowrule = center on, match:class (rnote)
windowrule = center on, match:class (xournalpp)
windowrule = center on, match:class ^(pamac)$
windowrule = center on, match:class ^(wine)$

# system update (waybar termnal)
windowrule = float on, animation popin, size (monitor_w*0.6) (monitor_h*0.5), center on, match:class ^($term)$, match:title ^(Auto_Update)$

# ttyclock
windowrule = float on, size (monitor_w*0.33) (monitor_h*0.27), center on, match:class ^(clock)$, match:title ^(clock)$

# calculator
windowrule = float on, match:class ^(galculator)$, match:title ^(galculator)$
windowrule = float on, size 360 620, center on, match:class .*(Calculator).*, match:title ^(Calculator)$

# gromit-mpx
# Note: Also enable shortcuts otherwise usage will be difficult
windowrule = workspace special:draw, suppress_event fullscreen, no_shadow on, border_size 0, no_anim on, no_blur on, no_dim on, float on, match:class ^(Gromit-mpx)$
#windowrulev2 = monitor $lMon  , class:^(Gromit-mpx)$ # Draw on all monitors
#windowrulev2 = stayfocused    , class:^(Gromit-mpx)$ # Gromit above waybar
#windowrulev2 = move 0 25      , class:^(Gromit-mpx)$ # Move gromit below waybar
#windowrulev2 = pin            , class:^(Gromit-mpx)$ # Disable "toggle off"

# Flameshot
# See: https://github.com/flameshot-org/flameshot/issues/2978#issuecomment-2543984205
# $monitors_w = $(hyprctl monitors all -j | jq '.[].width' | paste -s -d+ - | bc)
# $monitors_h = $(hyprctl monitors all -j | jq '.[].hight' | paste -s -d+ - | bc)
windowrule = workspace special:screenshot, suppress_event fullscreen, stay_focused on, no_shadow on, border_size 0, no_anim on, no_blur on, no_dim on, float on, move (0) (0), pin on, match:class ^(flameshot)$
windowrule = monitor $lMon, match:class ^(flameshot)$ # Screenshot all monitors

 # Papers
windowrule = suppress_event fullscreen, match:class ^(.*[Pp]apers)$

 # Godot
windowrule = tile on, match:class ^(Godot)$

 # nwg-drawer
#windowrulev2 = noanim, class:^(nwg-drawer)$

#   ##########################################################################
#  ###    Theming, etc.                                                   ###
# ##########################################################################
# See https://wiki.hyprland.org/Getting-Started/Master-Tutorial/#themes
source = ~/.config/hypr/hyprland-theme.conf # Import variables

#   ##########################################################################
#  ###    Keybindings, etc.                                               ###
# ##########################################################################
# See https://wiki.hypr.land/Configuring/Binds
source = ~/.config/hypr/hyprland-input.conf

#   ##########################################################################
#  ###    Startup rules, etc.                                             ###
# ##########################################################################
# See https://wiki.hyprland.org/Configuring/Keywords
source = ~/.config/hypr/hyprland-autostart.conf # Import variables

