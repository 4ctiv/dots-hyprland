#   ##########################################################################
#  ###    Startup rules, etc.                                             ###
# ##########################################################################
# See https://wiki.hyprland.org/Configuring/Keywords/ for more

#   ####################################
#  ### Variables, Definitions, etc. ###
# ####################################
source = ~/.config/hypr/hyprland-var.conf

#   ###############
#  ### scripts ###
# ###############
 exec-once = $scriptsDir/portal
 exec-once = $scriptsDir/core-software-setup
 exec-once = $scriptsDir/startup &
#exec-once = $scriptsDir/audio_setup &
 exec-once = $scriptsDir/auto-upgrade &

#   ########################
#  ### Systemd services ###
# ########################
#$warn = hyprctl notify -1 10000 "rgb(f38ba8)" "Can not enable/start one or more services" &
#exec-once = systemctl start --user xdg-desktop-portal-hyprland.service &
#exec-once = systemctl start --user xdg-desktop-portal-gtk.service &
#exec-once = systemctl start --user xdg-desktop-portal.service &
 exec-once = systemctl start --user hyprsunset.service &          # Backlight manager
 exec-once = systemctl start --user hyprpaper.service &           # Wallpaper manager
 exec-once = systemctl start --user hypridle.service &            # Idle      manager
#exec-once = systemctl start --user ssh-agent.service &           # ssh key   manager
#exec-once = systemctl start --user gpg-agent.service &           # gpg key   manager
#exec-once = systemctl start --user {docker,podman}.service &     # container manager
#exec-once = systemctl start --user pipewire.service &            # audio     provider
#exec-once = systemctl start --user waybar.service &              # navbar    provider
#exec-once = systemctl start --user mako.service &                # notify    provider

#   ###################
#  ### Dirty Fixes ###
# ###################

# Disable Bluetooth on login
 exec-once = bluetoothctl power off &

# Mute audio on login
 exec-once = pactl set-sink-mute @DEFAULT_SINK@ 1 & # mute active source

# Allow root aps GUI access
 exec-once = xhost si:localuser:root &

# Fix xwayland and wayland clipboard sync (since Hyprland 0.40.2)
 exec-once = $scriptsDir/fix_clipboard_xwayland.sh &

# Fix Slow app launch
exec-once = systemctl --user import-environment &
exec-once = hash dbus-update-activation-environment 2>/dev/null &
exec-once = dbus-update-activation-environment --systemd &

# Set default apps
 exec-once = xdg-mime default thunar.desktop inode/directory application/x-gnome-saved-search &
 exec-once = xdg-settings set default-web-browser brave.desktop &

# Connect polkit (PolicyKit)
 exec-once = /usr/lib/polkit-kde-authentication-agent-1 &

# Connect ssh-agent
 exec-once = eval $(ssh-agent -s) && ssh-add /home/activ/.ssh &

# Fix 802.11ac (Driver DVD mode)
#exec-once = sleep 5s && $scriptsDir/Fix_rtl_CD_modeswitch.sh

#   #################
#  ### Clipboard ###
# #################
# NOTE: When xwayland apps have issues with clipboard try reinstalling `xorg-xwayland`
#exec-once = wl-paste              --watch cliphist store
 exec-once = wl-paste --type text  --watch cliphist store & #Stores only text data
 exec-once = wl-paste --type image --watch cliphist store & #Stores only image data
 exec-once = cliphist wipe &

#   ######################
#  ### Autostart Apps ###
# ######################
# source = ~/.config/hypr/hyprland-autostart.conf
#
# Note: To exec after waybar is ready:
#   exec-once = nohup $scriptsDir/statusbar -w COMMAND COMMAND_ARGS >/dev/null 2>&1

# System Tray Apps
#exec-once = $scriptsDir/statusbar -w blueman-applet &
 exec-once = $scriptsDir/statusbar -w nm-applet --indicator &
#exec-once = $scriptsDir/statusbar -w flameshot &
#exec-once = $scriptsDir/statusbar -w kdeconnect-applet &
 exec-once = $scriptsDir/statusbar -w openrgb --startminimized -p "Catppuccin" &

# File management
 exec-once = $scriptsDir/statusbar -w keepassxc --minimized &
 exec-once = $scriptsDir/statusbar -w owncloud  -q &
#exec-once = $scriptsDir/statusbar -w nextcloud --background &
#exec-once = $scriptsDir/statusbar -w seafile-applet &
#exec-once = $scriptsDir/statusbar -w /usr/bin/cells-sync-bin-ui-launcher.sh -q &

# Games
#exec-once = lutris &
#exec-once = steam  -silent &
#exec-once = heroic -silent -nopipewire &

# Communication
#exec-once = noisetorch          -i &                   # Microphone noise reduction
 exec-once = [workspace name:mail silent] thunderbird & # Mail
 exec-once = element-desktop     --password-store="gnome-libsecret" --hidden &             # Matrix chat
#exec-once = discord             --start-minimized &    # Voice chat
#exec-once = ferdium &                                  # AiO Socials
#exec-once = signal-desktop      --start-in-tray &      # Secure chat
#exec-once = telegram-desktop     -startintray &        # group chat
#exec-once = whatsapp-nativefier &                      # insecure chat
           # Whatsapp startup tray: ```sed -i 's/"tray": "true"/"tray": "start-in-tray"/g' /opt/whatsapp-nativefier/resources/app/nativefier.json```

